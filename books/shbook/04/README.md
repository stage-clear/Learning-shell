# リダイレクションによるファイル操作

## 4.1 ファイルディスクリプタ

- プロセスとそれが使用するファイルとを結びつけています

|ファイルディスクリプタ|意味|
|:--:|:--|
|`0`|標準入力（普通はキーボードからの入力）|
|`1`|標準出力（普通は端末への出力）|
|`2`|標準エラー（普通は端末への出力）|


## 4.2 リダイレクション

- 普通の入力元や出力先を変えることをリダイレクションといいます
- リダイレクションとは、方向を変える、宛先を変えるという意味を持つ
- リダイレクト記号としては、`>` と `<` を基本的に用います

|リダイレクト記号|意味|
|:-:|:--|
|`>`|出力先をリダイレクト（左辺のデフォルトは `1>` ）|
|`<`|入力元をリダイレクト（右辺のデフォルトは `<0` ）|
|`>>`|出力先をリダイレクトし追記する|
|`a>&b`|`a` と　`b` を一緒にまとめる（ `2>&1` ）|

|記述法|説明|
|:--|:--|
|`>file`|標準出力を `file` というファイルに書く|
|`>>file`|標準出力を `file` というファイルに追加書きする|
|`>&m`|標準出力を `m` 番のファイルディスクリプタに書く|
|`>&-`|標準出力をクローズする|
|`<file`|標準入力を `file` というファイルから読み込む|
|`<&m`|標準入力を `m` というファイルディスクリプタから読み込む|
|`<&-`|標準入力をクローズする|
|`<<word`|標準入力をヒア・ドキュメントから読み込む|

（デフォルトのファイルディスクリプタ（`1` `0`）は省略）

__注意点__

- 指定できるファイルディスクリプタの番号は `0` から `9` まで
- リダイレクト記号とファイルディスクリプタ番号との間にスペースを空けない


__例) リダイレクトする__

（現在の作業ディレクトリには何もファイルがないものとする）

```sh
$ echo abcdefg        # echo は「標準出力」に書く
abcdefg               # 結果は画面に表示される
$ echo abcdef > abc   # 出力をファイル `abc` に向ける
$                     # 画面には表示されない
$ cat abc             # ファイル `abc` に `echo` した内容が書き込まれた
abcdef
$
```

__例) リダイレクトした出力先に追加書きする__

```sh
$ echo  123456 > abc  # 別の出力を書き込んでみる
$ cat abc             # abc の内容をみる
123456                # 結果は新しく書き換わった
$
$ echo xyz >> abc     # >> というリダイレクト記号を使うと
$ cat abc             # 結果は追記されている
123456
xyz
```

__例) 標準出力の向きだけを変える__

```sh
$ cat abc xxx         # `abc` と `xxx` というファイルを cat する
123456                # `abc` の中身は表示されるが、
xyz                   # `xxx` とういファイルは存在しないのでエラー
cat: xxx: No such file or directory
$ cat abc xxx > nnn   # 同じことをリダイレクトすると
cat: xxx: No such file or directory # エラーだけが画面に出た
$                     # `nnn` というファイルには abc の中身が書かれました
```

__例) エラーだけをリダイレクトする__

```sh
$ cat abc xxx 2> nnn    # 「標準エラー」の2番をファイル `nnn` に向ける
abcdef                  # `abc` の内容は標準出力に書かれる
xyz                     # このように画面に表示される
$
$                       # `nnn` というファイルにはエラーが書かれました
```

__例) 標準出力と標準エラーをひとまとめにリダイレクトする__

```sh
$ cat abc xxx > nnn 2>&1
```

複数のリダイレクト記号が1行にあるときは「左から右」に判定される


__例) 標準入力をリダイレクトする__

キーボードからの入力するのではなくファイルを読ませてあたかもキーボードから入力したかのよ
うに見せかける。
`$ ls -l abc nnn` と書かれたファイル `xyz` を用意する。

```sh
$ cat xyz
ls -l abc nnn
$ sh < xyz              # `xyz` ファイルを「sh の標準入力」としてリダイレクトする
-rw-r--r--  1 nepdigital  staff   7 11 13 18:44 abc
-rw-r--r--  1 nepdigital  staff  43 11 13 18:51 nnn
$                       # 結果は `ls -l abc nnn` を入力したときと同じ
```

__例) あるコマンドの実行結果やエラーをすべて捨てる__

```sh
$ command > dev/null 2>&1
$
# 誤った書き方
$ command 2>&1 > dev/null
```
